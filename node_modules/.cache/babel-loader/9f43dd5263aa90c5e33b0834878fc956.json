{"ast":null,"code":"import firebase from 'firebase';\nconst config = {\n  apiKey: \"AIzaSyApwjHjFIfP0VmtAqFH-Cp5Kha2GnD6q3E\",\n  authDomain: \"inventario-fablabuv.firebaseapp.com\",\n  databaseURL: \"https://inventario-fablabuv.firebaseio.com\",\n  projectId: \"inventario-fablabuv\",\n  storageBucket: \"inventario-fablabuv.appspot.com\",\n  messagingSenderId: \"1070405211534\",\n  appId: \"1:1070405211534:web:d7275629df2fb90bc900df\",\n  measurementId: \"G-PG0YWD8M1Z\"\n};\nconst firebaseConf = firebase.initializeApp(config);\nexport default firebaseConf;\nexport const getListaProducto = callback => {\n  const temp = [];\n  firebaseConf.database().ref().child(\"productos\").orderByChild(\"marca\").once(\"value\", snapshot => {\n    snapshot.forEach(datos => {\n      const data = {\n        codigo: datos.val().codigo,\n        marca: datos.val().marca,\n        modelo: datos.val().modelo,\n        stock: datos.val().stock,\n        disponible: datos.val().disponible,\n        ubicacion: datos.val().ubicacion,\n        key: datos.key\n      };\n      temp.push(data);\n    });\n    callback(temp);\n  });\n};\nexport const getListaRegistro = callback => {\n  const temp = [];\n  firebaseConf.firestore().collection('registros').orderBy('fecha').onSnapshot(querySnapshot => {\n    querySnapshot.forEach(data => {\n      temp.push(data.data());\n    });\n    callback(temp.reverse());\n  });\n};\nexport const setRegistro = (data_subir, callback) => {\n  firebaseConf.firestore().collection('registros').add(data_subir).then(() => {\n    callback(true);\n  }).catch(() => {\n    callback(false);\n  });\n};\nexport const updateProducto = (ruta, datos) => {\n  firebaseConf.database().ref().child('productos').child(String(ruta)).update({\n    \"disponible\": datos\n  }).then(() => {}).catch(() => {});\n};\nexport const updateProductoStock = (new_stock, new_disp, ruta) => {\n  firebaseConf.database().ref().child('productos').child(String(ruta)).update({\n    \"disponible\": new_disp,\n    \"stock\": new_stock\n  }).then(() => {}).catch(() => {});\n};\nexport const setProducto = (datos, callback) => {\n  firebaseConf.database().ref().child('productos').push(datos).then(() => callback(true)).catch(() => {\n    callback(false);\n  });\n};\nexport const removeProducto = ruta => {\n  firebaseConf.database().ref().child('productos').child(String(ruta)).remove();\n};\nexport const ingresarLogin = (userNick, userPassword, callback) => {\n  firebaseConf.auth().signInWithEmailAndPassword(userNick, userPassword).then(function (result) {\n    window.localStorage.setItem('token_inventarioUV', Math.random().toString(36).substr(2) + Math.random().toString(36).substr(2));\n    window.localStorage.setItem('user_inventarioUV', userNick);\n\n    if (userNick === 'admin@inventariofablab.uv.cl') {\n      window.localStorage.setItem('permisos_inventarioUV', '0');\n    }\n\n    if (userNick === 'visita@inventariofablab.uv.cl') {\n      window.localStorage.setItem('permisos_inventarioUV', '2');\n    }\n\n    if (userNick === 'ayudantes@inventariofablab.uv.cl') {\n      window.localStorage.setItem('permisos_inventarioUV', '1');\n    }\n\n    window.location = '/home';\n  }).catch(() => {\n    callback(false);\n  });\n};\nexport const getTipoRegistrovsCantidad = (ano, callback) => {\n  var query = [];\n  var cont = 0;\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano).where('peticion', \"==\", \"Entrega de producto\").get().then(function (querySnapshot) {\n    query.push({\n      x: \"Entrega de producto\",\n      y: querySnapshot.size\n    });\n    cont = cont + 1;\n\n    if (cont === 5) {\n      callback(query);\n    }\n  });\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano).where('peticion', \"==\", \"Devolucion de producto\").get().then(function (querySnapshot) {\n    query.push({\n      x: \"Devolucion de producto\",\n      y: querySnapshot.size\n    });\n    cont = cont + 1;\n\n    if (cont === 5) {\n      callback(query);\n    }\n  });\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano).where('peticion', \"==\", \"Actualizar stock\").get().then(function (querySnapshot) {\n    query.push({\n      x: \"Actualizar stock\",\n      y: querySnapshot.size\n    });\n    cont = cont + 1;\n\n    if (cont === 5) {\n      callback(query);\n    }\n  });\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano).where('peticion', \"==\", \"Nuevo producto\").get().then(function (querySnapshot) {\n    query.push({\n      x: \"Nuevo producto\",\n      y: querySnapshot.size\n    });\n    cont = cont + 1;\n\n    if (cont === 5) {\n      callback(query);\n    }\n  });\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano).where('peticion', \"==\", \"Producto removido\").get().then(function (querySnapshot) {\n    query.push({\n      x: \"Producto removido\",\n      y: querySnapshot.size\n    });\n    cont = cont + 1;\n\n    if (cont === 5) {\n      callback(query);\n    }\n  });\n};\nexport const updateHistorica = (ruta, cantidad) => {\n  var value;\n  firebaseConf.database().ref().child('productos').child(String(ruta)).once(\"value\", snapshot => {\n    value = snapshot.val().historica_pedidos + cantidad;\n    firebaseConf.database().ref().child('productos').child(String(ruta)).update({\n      \"historica_pedidos\": value\n    });\n  });\n};\nexport const setDatosGrafico = (marca, modelo, cantidad, año, mes) => {\n  let temp_subir = {\n    marca: marca,\n    modelo: modelo,\n    cantidad: cantidad,\n    año: año,\n    mes: mes\n  };\n  var bandera = false;\n  firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").orderByChild('modelo').equalTo(modelo).once('value', function (snapshot) {\n    snapshot.forEach(data => {\n      if (data.val().año === año && data.val().mes === mes && data.val().marca === marca) {\n        let nueva_cantidad = data.val().cantidad + cantidad;\n        bandera = true;\n        firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").child(data.key).update({\n          \"cantidad\": nueva_cantidad\n        });\n      }\n    });\n  }).finally(() => {\n    if (!bandera) {\n      firebaseConf.database().ref().child('datos-grafico').child('entrega').push(temp_subir);\n    }\n  });\n};\nexport const getDatosHistoricosProductos = callback => {\n  var return_value = [];\n  firebaseConf.database().ref().child('productos').orderByChild('historica_pedidos').limitToLast(10).once('value', snapshot => {\n    snapshot.forEach(data => {\n      return_value.push({\n        id: data.val().marca + \" - \" + data.val().modelo,\n        label: data.val().marca + \"  \" + data.val().modelo,\n        value: data.val().historica_pedidos\n      });\n    });\n    callback(return_value);\n  });\n};\nexport const getDatosGraficosBarra = (año, mes, callbackdatos) => {\n  var temp_datos = [];\n  var datos_enviar = [];\n  var key = [];\n  firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").orderByChild('cantidad').once('value', function (snapshot) {\n    snapshot.forEach(dato => {\n      if (dato.val().año === año && dato.val().mes === mes) {\n        temp_datos.push(dato.val());\n      }\n    });\n  }).finally(() => {\n    temp_datos.reverse().forEach(datos => {\n      if (datos_enviar.length < 10) {\n        datos_enviar.push({\n          id: datos.marca + \" - \" + datos.modelo,\n          label: datos.marca + \"  \" + datos.modelo,\n          value: datos.cantidad\n        });\n      }\n    });\n    callbackdatos(datos_enviar);\n  });\n};\nexport const getListaRegistroHome = (callback, termino) => {\n  const temp = [];\n  firebaseConf.firestore().collection('registros').orderBy('fecha').limitToLast(3).onSnapshot(querySnapshot => {\n    querySnapshot.forEach(data => {\n      temp.push(data.data());\n    });\n    callback(temp.reverse());\n    termino(true);\n  });\n};\nexport const getTipoRegistroHome = (callback, termino) => {\n  var cont = 0;\n  var date = new Date();\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", date.getFullYear()).get().then(function (snapshot) {\n    cont = snapshot.size;\n  }).finally(() => {\n    callback(cont);\n    termino(true);\n  });\n};\nexport const getEntregasMes = (callback, termino) => {\n  var cont = 0;\n  var date = new Date();\n  let año = date.getFullYear();\n  let mes = date.getMonth();\n  var temp_datos = [];\n  firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").orderByChild('cantidad').once('value', function (snapshot) {\n    snapshot.forEach(dato => {\n      if (dato.val().año === año && dato.val().mes === mes) {\n        temp_datos.push(dato.val());\n      }\n    });\n  }).finally(() => {\n    callback(temp_datos.length);\n    termino(true);\n  });\n};\nexport const getDevolucionesHome = (callback, termino) => {\n  var cont = 0;\n  firebaseConf.database().ref().child(\"productos\").once('value', function (snapshot) {\n    snapshot.forEach(dato => {\n      if (dato.val().stock !== dato.val().disponible) {\n        cont++;\n      }\n    });\n  }).finally(() => {\n    callback(cont);\n    termino(true);\n  });\n};","map":{"version":3,"sources":["/Users/diego/Documents/8_semestre/Taller-de-Aplicaciones/inventarioFablab/src/firebase.js"],"names":["firebase","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","firebaseConf","initializeApp","getListaProducto","callback","temp","database","ref","child","orderByChild","once","snapshot","forEach","datos","data","codigo","val","marca","modelo","stock","disponible","ubicacion","key","push","getListaRegistro","firestore","collection","orderBy","onSnapshot","querySnapshot","reverse","setRegistro","data_subir","add","then","catch","updateProducto","ruta","String","update","updateProductoStock","new_stock","new_disp","setProducto","removeProducto","remove","ingresarLogin","userNick","userPassword","auth","signInWithEmailAndPassword","result","window","localStorage","setItem","Math","random","toString","substr","location","getTipoRegistrovsCantidad","ano","query","cont","where","get","x","y","size","updateHistorica","cantidad","value","historica_pedidos","setDatosGrafico","año","mes","temp_subir","bandera","equalTo","nueva_cantidad","finally","getDatosHistoricosProductos","return_value","limitToLast","id","label","getDatosGraficosBarra","callbackdatos","temp_datos","datos_enviar","dato","length","getListaRegistroHome","termino","getTipoRegistroHome","date","Date","getFullYear","getEntregasMes","getMonth","getDevolucionesHome"],"mappings":"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","sourcesContent":["import firebase from 'firebase';\n\nconst config = {\n\n    apiKey: \"AIzaSyApwjHjFIfP0VmtAqFH-Cp5Kha2GnD6q3E\",\n    authDomain: \"inventario-fablabuv.firebaseapp.com\",\n    databaseURL: \"https://inventario-fablabuv.firebaseio.com\",\n    projectId: \"inventario-fablabuv\",\n    storageBucket: \"inventario-fablabuv.appspot.com\",\n    messagingSenderId: \"1070405211534\",\n    appId: \"1:1070405211534:web:d7275629df2fb90bc900df\",\n    measurementId: \"G-PG0YWD8M1Z\"\n\n}\n\nconst firebaseConf = firebase.initializeApp(config);\nexport default firebaseConf;\n\n\nexport const getListaProducto = (callback) => {\n    const temp = [];\n    firebaseConf.database().ref().child(\"productos\").orderByChild(\"marca\").once(\"value\", snapshot => {\n        snapshot.forEach(datos => {\n            const data = { codigo: datos.val().codigo, marca: datos.val().marca, modelo: datos.val().modelo, stock: datos.val().stock, disponible: datos.val().disponible, ubicacion: datos.val().ubicacion, key: datos.key }\n            temp.push(data);\n        })\n        callback(temp)\n    });\n};\n\nexport const getListaRegistro = (callback) => {\n    const temp = [];\n    firebaseConf.firestore().collection('registros').orderBy('fecha').onSnapshot(querySnapshot => {\n        querySnapshot.forEach(data => {\n            temp.push(data.data())\n        })\n        callback(temp.reverse());\n    })\n};\n\nexport const setRegistro = (data_subir, callback) => {\n    firebaseConf.firestore().collection('registros').add(data_subir).then(() => {\n        callback(true)\n    }).catch(() => {\n        callback(false)\n    })\n};\n\nexport const updateProducto = (ruta, datos) => {\n    firebaseConf.database().ref().child('productos').child(String(ruta)).update({\n        \"disponible\": datos\n    }).then(() => {\n    }).catch(() => {\n    })\n};\n\nexport const updateProductoStock = (new_stock, new_disp, ruta) => {\n    firebaseConf.database().ref().child('productos').child(String(ruta)).update({\n        \"disponible\": new_disp,\n        \"stock\": new_stock\n    }).then(() => {\n    }).catch(() => {\n    })\n};\n\nexport const setProducto = (datos, callback) => {\n\n    firebaseConf.database().ref().child('productos').push(datos).then(() => callback(true)).catch(() => { callback(false) })\n};\n\nexport const removeProducto = (ruta) => {\n\n    firebaseConf.database().ref().child('productos').child(String(ruta)).remove();\n};\n\nexport const ingresarLogin = (userNick, userPassword, callback) => {\n\n    firebaseConf.auth().signInWithEmailAndPassword(userNick, userPassword).then(function (result) {\n        window.localStorage.setItem('token_inventarioUV', Math.random().toString(36).substr(2) + Math.random().toString(36).substr(2));\n        window.localStorage.setItem('user_inventarioUV', userNick)\n        if (userNick === 'admin@inventariofablab.uv.cl') {\n            window.localStorage.setItem('permisos_inventarioUV', '0')\n        }\n        if (userNick === 'visita@inventariofablab.uv.cl') {\n            window.localStorage.setItem('permisos_inventarioUV', '2')\n        }\n        if (userNick === 'ayudantes@inventariofablab.uv.cl') {\n            window.localStorage.setItem('permisos_inventarioUV', '1')\n        }\n        window.location = '/home';\n    }).catch(() => {\n        callback(false)\n    })\n};\n\n\nexport const getTipoRegistrovsCantidad = (ano, callback) => {\n\n    var query = [];\n    var cont = 0;\n\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano)\n        .where('peticion', \"==\", \"Entrega de producto\").get().then(function (querySnapshot) {\n            query.push({ x: \"Entrega de producto\", y: querySnapshot.size })\n            cont = cont + 1;\n            if (cont === 5) {\n                callback(query)\n            }\n        });\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano)\n        .where('peticion', \"==\", \"Devolucion de producto\").get().then(function (querySnapshot) {\n            query.push({ x: \"Devolucion de producto\", y: querySnapshot.size })\n            cont = cont + 1;\n            if (cont === 5) {\n                callback(query)\n            }\n        });\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano)\n        .where('peticion', \"==\", \"Actualizar stock\").get().then(function (querySnapshot) {\n            query.push({ x: \"Actualizar stock\", y: querySnapshot.size })\n            cont = cont + 1;\n            if (cont === 5) {\n                callback(query)\n            }\n        });\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano)\n        .where('peticion', \"==\", \"Nuevo producto\").get().then(function (querySnapshot) {\n            query.push({ x: \"Nuevo producto\", y: querySnapshot.size })\n            cont = cont + 1;\n            if (cont === 5) {\n                callback(query)\n            }\n        });\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano)\n        .where('peticion', \"==\", \"Producto removido\").get().then(function (querySnapshot) {\n            query.push({ x: \"Producto removido\", y: querySnapshot.size })\n            cont = cont + 1;\n            if (cont === 5) {\n                callback(query)\n            }\n        });\n\n}\n\nexport const updateHistorica = (ruta, cantidad) => {\n\n    var value;\n    firebaseConf.database().ref().child('productos').child(String(ruta)).once(\"value\", snapshot => {\n        value = snapshot.val().historica_pedidos + cantidad\n        firebaseConf.database().ref().child('productos').child(String(ruta)).update({\n            \"historica_pedidos\": value\n        })\n    })\n}\n\n\nexport const setDatosGrafico = (marca, modelo, cantidad, año, mes) => {\n\n    let temp_subir = { marca: marca, modelo: modelo, cantidad: cantidad, año: año, mes: mes }\n    var bandera = false;\n    firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").orderByChild('modelo')\n    .equalTo(modelo).once('value', function (snapshot) {\n            snapshot.forEach(data =>{\n               if (data.val().año === año && data.val().mes === mes && data.val().marca === marca) {\n                   let nueva_cantidad = data.val().cantidad + cantidad\n                   bandera = true;\n                   firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").child(data.key).update({\n                       \"cantidad\": nueva_cantidad\n                   })\n                }\n            })\n        }).finally(() =>{\n            if (!bandera) {\n                firebaseConf.database().ref().child('datos-grafico').child('entrega').push(temp_subir)\n            }\n        })\n}\n\nexport const getDatosHistoricosProductos = (callback) => {\n    var return_value = []\n    firebaseConf.database().ref().child('productos').orderByChild('historica_pedidos').\n        limitToLast(10).once('value', snapshot => {\n            snapshot.forEach((data) => {\n                return_value.push({ id: data.val().marca + \" - \" + data.val().modelo, label: data.val().marca + \"  \" + data.val().modelo, value: data.val().historica_pedidos })\n            })\n            callback(return_value)\n        })\n}\n\nexport const getDatosGraficosBarra = (año, mes, callbackdatos ) => {\n    var temp_datos = []\n    var datos_enviar = []\n    var key = []\n\n    firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").orderByChild('cantidad').once('value', function(snapshot){\n        snapshot.forEach((dato) =>{\n            if (dato.val().año === año && dato.val().mes === mes) {\n                temp_datos.push(dato.val())\n            }\n        })\n    }).finally(()=>{\n        temp_datos.reverse().forEach(datos => {\n            if (datos_enviar.length < 10) {\n                datos_enviar.push({ id: datos.marca + \" - \" + datos.modelo, label: datos.marca + \"  \" + datos.modelo, value: datos.cantidad })\n            }\n        })\n        callbackdatos(datos_enviar)\n    })\n}\n\nexport const getListaRegistroHome = (callback, termino) => {\n    const temp = [];\n    firebaseConf.firestore().collection('registros').orderBy('fecha').limitToLast(3).onSnapshot(querySnapshot => {\n        querySnapshot.forEach(data => {\n            temp.push(data.data())\n        })\n        callback(temp.reverse());\n        termino(true)\n    })\n};\n\n\nexport const getTipoRegistroHome = (callback, termino) => {\n\n    var cont = 0;\n    var date = new Date();\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", date.getFullYear())\n        .get().then(function (snapshot) {\n            cont = snapshot.size;\n        }).finally(() => {\n            callback(cont);\n            termino(true)\n        });\n}\n\nexport const getEntregasMes = (callback, termino) => {\n    var cont  = 0\n    var date = new Date();\n    let año = date.getFullYear(); let mes = date.getMonth();\n    var temp_datos = []\n\n    firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").orderByChild('cantidad').once('value', function (snapshot) {\n        snapshot.forEach((dato) => {\n            if (dato.val().año === año && dato.val().mes === mes) {\n                temp_datos.push(dato.val())\n            }\n        })\n    }).finally(()=> {\n        callback(temp_datos.length);\n        termino(true)\n    })\n}\n\nexport const getDevolucionesHome = (callback, termino) => {\n    var cont = 0\n\n    firebaseConf.database().ref().child(\"productos\").once('value', function (snapshot) {\n        snapshot.forEach((dato) => {\n            if (dato.val().stock !== dato.val().disponible) {\n                cont++;\n            }\n        })\n    }).finally(() => {\n        callback(cont);\n        termino(true)\n    })\n}\n"]},"metadata":{},"sourceType":"module"}