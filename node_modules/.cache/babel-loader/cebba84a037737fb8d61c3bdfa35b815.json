{"ast":null,"code":"import firebase from 'firebase';\nconst config = {\n  apiKey: \"AIzaSyApwjHjFIfP0VmtAqFH-Cp5Kha2GnD6q3E\",\n  authDomain: \"inventario-fablabuv.firebaseapp.com\",\n  databaseURL: \"https://inventario-fablabuv.firebaseio.com\",\n  projectId: \"inventario-fablabuv\",\n  storageBucket: \"inventario-fablabuv.appspot.com\",\n  messagingSenderId: \"1070405211534\",\n  appId: \"1:1070405211534:web:d7275629df2fb90bc900df\",\n  measurementId: \"G-PG0YWD8M1Z\"\n};\nconst firebaseConf = firebase.initializeApp(config);\nexport default {\n  firebaseConf\n};\nexport const getListaProducto = callback => {\n  const temp = [];\n  firebaseConf.database().ref().child(\"productos\").orderByChild(\"marca\").once(\"value\", snapshot => {\n    snapshot.forEach(datos => {\n      const data = {\n        codigo: datos.val().codigo,\n        marca: datos.val().marca,\n        modelo: datos.val().modelo,\n        stock: datos.val().stock,\n        disponible: datos.val().disponible,\n        ubicacion: datos.val().ubicacion,\n        key: datos.key\n      };\n      temp.push(data);\n    });\n    callback(temp);\n  });\n};\nexport const getListaRegistro = callback => {\n  const temp = [];\n  firebaseConf.firestore().collection('registros').orderBy('fecha').onSnapshot(querySnapshot => {\n    querySnapshot.forEach(data => {\n      temp.push(data.data());\n    });\n    callback(temp.reverse());\n  });\n};\nexport const setRegistro = (data_subir, callback) => {\n  firebaseConf.firestore().collection('registros').add(data_subir).then(() => {\n    callback(true);\n  }).catch(() => {\n    callback(false);\n  });\n};\nexport const updateProducto = (ruta, datos) => {\n  firebaseConf.database().ref().child('productos').child(String(ruta)).update({\n    \"disponible\": datos\n  }).then(() => {}).catch(() => {});\n};\nexport const updateProductoStock = (new_stock, new_disp, ruta) => {\n  firebaseConf.database().ref().child('productos').child(String(ruta)).update({\n    \"disponible\": new_disp,\n    \"stock\": new_stock\n  }).then(() => {}).catch(() => {});\n};\nexport const setProducto = (datos, callback) => {\n  firebaseConf.database().ref().child('productos').push(datos).then(() => callback(true)).catch(() => {\n    callback(false);\n  });\n};\nexport const removeProducto = ruta => {\n  firebaseConf.database().ref().child('productos').child(String(ruta)).remove();\n};\nexport const ingresarLogin = (userNick, userPassword, callback) => {\n  firebaseConf.auth().signInWithEmailAndPassword(userNick, userPassword).then(function (result) {\n    window.localStorage.setItem('token_inventarioUV', Math.random().toString(36).substr(2) + Math.random().toString(36).substr(2));\n    window.localStorage.setItem('user_inventarioUV', userNick);\n\n    if (userNick === 'admin@inventariofablab.uv.cl') {\n      window.localStorage.setItem('permisos_inventarioUV', '0');\n    }\n\n    if (userNick === 'visita@inventariofablab.uv.cl') {\n      window.localStorage.setItem('permisos_inventarioUV', '2');\n    }\n\n    if (userNick === 'ayudantes@inventariofablab.uv.cl') {\n      window.localStorage.setItem('permisos_inventarioUV', '1');\n    }\n\n    window.location = '/home';\n  }).catch(() => {\n    callback(false);\n  });\n};\nexport const getTipoRegistrovsCantidad = (ano, callback, termino) => {\n  var query = [];\n  var cont = 0;\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano).where('peticion', \"==\", \"Entrega de producto\").get().then(function (querySnapshot) {\n    query.push({\n      x: \"Entrega de producto\",\n      y: querySnapshot.size\n    });\n    cont = cont + 1;\n\n    if (cont === 5) {\n      callback(query);\n      termino(true);\n    }\n  });\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano).where('peticion', \"==\", \"Devolucion de producto\").get().then(function (querySnapshot) {\n    query.push({\n      x: \"Devolucion de producto\",\n      y: querySnapshot.size\n    });\n    cont = cont + 1;\n\n    if (cont === 5) {\n      callback(query);\n      termino(true);\n    }\n  });\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano).where('peticion', \"==\", \"Actualizar stock\").get().then(function (querySnapshot) {\n    query.push({\n      x: \"Actualizar stock\",\n      y: querySnapshot.size\n    });\n    cont = cont + 1;\n\n    if (cont === 5) {\n      callback(query);\n      termino(true);\n    }\n  });\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano).where('peticion', \"==\", \"Nuevo producto\").get().then(function (querySnapshot) {\n    query.push({\n      x: \"Nuevo producto\",\n      y: querySnapshot.size\n    });\n    cont = cont + 1;\n\n    if (cont === 5) {\n      callback(query);\n      termino(true);\n    }\n  });\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano).where('peticion', \"==\", \"Producto removido\").get().then(function (querySnapshot) {\n    query.push({\n      x: \"Producto removido\",\n      y: querySnapshot.size\n    });\n    cont = cont + 1;\n\n    if (cont === 5) {\n      callback(query);\n      termino(true);\n    }\n  });\n};\nexport const updateHistorica = (ruta, cantidad) => {\n  var value;\n  firebaseConf.database().ref().child('productos').child(String(ruta)).once(\"value\", snapshot => {\n    value = snapshot.val().historica_pedidos + cantidad;\n    firebaseConf.database().ref().child('productos').child(String(ruta)).update({\n      \"historica_pedidos\": value\n    });\n  });\n};\nexport const setDatosGrafico = (marca, modelo, cantidad, año, mes) => {\n  let temp_subir = {\n    marca: marca,\n    modelo: modelo,\n    cantidad: cantidad,\n    año: año,\n    mes: mes\n  };\n  var bandera = false;\n  firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").orderByChild('modelo').equalTo(modelo).once('value', function (snapshot) {\n    snapshot.forEach(data => {\n      if (data.val().año === año && data.val().mes === mes && data.val().marca === marca) {\n        let nueva_cantidad = data.val().cantidad + cantidad;\n        bandera = true;\n        firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").child(data.key).update({\n          \"cantidad\": nueva_cantidad\n        });\n      }\n    });\n  }).finally(() => {\n    if (!bandera) {\n      firebaseConf.database().ref().child('datos-grafico').child('entrega').push(temp_subir);\n    }\n  });\n};\nexport const getDatosHistoricosProductos = callback => {\n  var return_value = [];\n  firebaseConf.database().ref().child('productos').orderByChild('historica_pedidos').limitToLast(5).once('value', snapshot => {\n    snapshot.forEach(data => {\n      return_value.push({\n        id: data.val().marca + \" - \" + data.val().modelo,\n        label: data.val().marca + \"  \" + data.val().modelo,\n        value: data.val().historica_pedidos\n      });\n    });\n    callback(return_value);\n  });\n};\nexport const getDatosGraficosBarra = (año, mes, callbackdatos) => {\n  var temp_datos = [];\n  var datos_enviar = [];\n  var key = [];\n  firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").orderByChild('cantidad').once('value', function (snapshot) {\n    snapshot.forEach(dato => {\n      if (dato.val().año === año && dato.val().mes === mes) {\n        temp_datos.push(dato.val());\n      }\n    });\n  }).finally(() => {\n    temp_datos.reverse().forEach(datos => {\n      if (datos_enviar.length < 10) {\n        datos_enviar.push({\n          id: datos.marca + \" - \" + datos.modelo,\n          label: datos.marca + \"  \" + datos.modelo,\n          value: datos.cantidad\n        });\n      }\n    });\n    callbackdatos(datos_enviar);\n  });\n};\nexport const getListaRegistroHome = (callback, termino) => {\n  const temp = [];\n  firebaseConf.firestore().collection('registros').orderBy('fecha').limitToLast(3).onSnapshot(querySnapshot => {\n    querySnapshot.forEach(data => {\n      temp.push(data.data());\n    });\n    callback(temp.reverse());\n    termino(true);\n  });\n};\nexport const getTipoRegistroHome = (callback, termino) => {\n  var cont = 0;\n  var date = new Date();\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", date.getFullYear()).get().then(function (snapshot) {\n    cont = snapshot.size;\n  }).finally(() => {\n    callback(cont);\n    termino(true);\n  });\n};\nexport const getEntregasMes = (callback, termino) => {\n  var cont = 0;\n  var date = new Date();\n  let año = date.getFullYear();\n  let mes = date.getMonth();\n  firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").orderByChild('cantidad').once('value', function (snapshot) {\n    snapshot.forEach(dato => {\n      if (dato.val().año === año && dato.val().mes === mes) {\n        cont = cont + dato.val().cantidad;\n      }\n    });\n  }).finally(() => {\n    callback(cont);\n    termino(true);\n  });\n};\nexport const getDevolucionesHome = (callback, termino) => {\n  var cont = 0;\n  firebaseConf.database().ref().child(\"productos\").once('value', function (snapshot) {\n    snapshot.forEach(dato => {\n      if (dato.val().stock !== dato.val().disponible) {\n        cont++;\n      }\n    });\n  }).finally(() => {\n    callback(cont);\n    termino(true);\n  });\n};\nexport const getRegistrosMensual = (callback, termino) => {\n  var cont = 0;\n  var date = new Date();\n  firebaseConf.firestore().collection('registros').where(\"año\", \"==\", date.getFullYear()).where(\"mes\", \"==\", date.getMonth()).get().then(function (snapshot) {\n    cont = snapshot.size;\n  }).finally(() => {\n    callback(cont);\n    termino(true);\n  });\n};\nexport const setArchivo = (archivo, nombre, callback, porcentaje, termino) => {\n  var ruta_nombre = Date.now() + \"-\" + nombre;\n  firebaseConf.storage().ref('registros/resoluciones/' + ruta_nombre).put(archivo).on('state_changed', snapshot => {\n    var temp = snapshot.bytesTransferred / snapshot.totalBytes * 100;\n    porcentaje(temp);\n  }, error => {\n    console.log(\"error \" + error);\n    alert(\"Error al subir los datos \" + error);\n    termino(false);\n  }, () => {\n    firebaseConf.storage().ref('registros/resoluciones').child(ruta_nombre).getDownloadURL().then(url => {\n      callback(String(url));\n      termino(true);\n    });\n  });\n};","map":{"version":3,"sources":["/Users/diego/Documents/8_semestre/Taller-de-Aplicaciones/inventarioFablab/src/firebase.js"],"names":["firebase","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","firebaseConf","initializeApp","getListaProducto","callback","temp","database","ref","child","orderByChild","once","snapshot","forEach","datos","data","codigo","val","marca","modelo","stock","disponible","ubicacion","key","push","getListaRegistro","firestore","collection","orderBy","onSnapshot","querySnapshot","reverse","setRegistro","data_subir","add","then","catch","updateProducto","ruta","String","update","updateProductoStock","new_stock","new_disp","setProducto","removeProducto","remove","ingresarLogin","userNick","userPassword","auth","signInWithEmailAndPassword","result","window","localStorage","setItem","Math","random","toString","substr","location","getTipoRegistrovsCantidad","ano","termino","query","cont","where","get","x","y","size","updateHistorica","cantidad","value","historica_pedidos","setDatosGrafico","año","mes","temp_subir","bandera","equalTo","nueva_cantidad","finally","getDatosHistoricosProductos","return_value","limitToLast","id","label","getDatosGraficosBarra","callbackdatos","temp_datos","datos_enviar","dato","length","getListaRegistroHome","getTipoRegistroHome","date","Date","getFullYear","getEntregasMes","getMonth","getDevolucionesHome","getRegistrosMensual","setArchivo","archivo","nombre","porcentaje","ruta_nombre","now","storage","put","on","bytesTransferred","totalBytes","error","console","log","alert","getDownloadURL","url"],"mappings":"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","sourcesContent":["import firebase from 'firebase';\n\nconst config = {\n\n    apiKey: \"AIzaSyApwjHjFIfP0VmtAqFH-Cp5Kha2GnD6q3E\",\n    authDomain: \"inventario-fablabuv.firebaseapp.com\",\n    databaseURL: \"https://inventario-fablabuv.firebaseio.com\",\n    projectId: \"inventario-fablabuv\",\n    storageBucket: \"inventario-fablabuv.appspot.com\",\n    messagingSenderId: \"1070405211534\",\n    appId: \"1:1070405211534:web:d7275629df2fb90bc900df\",\n    measurementId: \"G-PG0YWD8M1Z\"\n\n}\n\nconst firebaseConf = firebase.initializeApp(config);\nexport default { firebaseConf };\n\n\n\nexport const getListaProducto = (callback) => {\n    const temp = [];\n    firebaseConf.database().ref().child(\"productos\").orderByChild(\"marca\").once(\"value\", snapshot => {\n        snapshot.forEach(datos => {\n            const data = { codigo: datos.val().codigo, marca: datos.val().marca, modelo: datos.val().modelo, stock: datos.val().stock, disponible: datos.val().disponible, ubicacion: datos.val().ubicacion, key: datos.key }\n            temp.push(data);\n        })\n        callback(temp)\n    });\n};\n\nexport const getListaRegistro = (callback) => {\n    const temp = [];\n    firebaseConf.firestore().collection('registros').orderBy('fecha').onSnapshot(querySnapshot => {\n        querySnapshot.forEach(data => {\n            temp.push(data.data())\n        })\n        callback(temp.reverse());\n    })\n};\n\nexport const setRegistro = (data_subir, callback) => {\n    firebaseConf.firestore().collection('registros').add(data_subir).then(() => {\n        callback(true)\n    }).catch(() => {\n        callback(false)\n    })\n};\n\nexport const updateProducto = (ruta, datos) => {\n    firebaseConf.database().ref().child('productos').child(String(ruta)).update({\n        \"disponible\": datos\n    }).then(() => {\n    }).catch(() => {\n    })\n};\n\nexport const updateProductoStock = (new_stock, new_disp, ruta) => {\n    firebaseConf.database().ref().child('productos').child(String(ruta)).update({\n        \"disponible\": new_disp,\n        \"stock\": new_stock\n    }).then(() => {\n    }).catch(() => {\n    })\n};\n\nexport const setProducto = (datos, callback) => {\n\n    firebaseConf.database().ref().child('productos').push(datos).then(() => callback(true)).catch(() => { callback(false) })\n};\n\nexport const removeProducto = (ruta) => {\n\n    firebaseConf.database().ref().child('productos').child(String(ruta)).remove();\n};\n\nexport const ingresarLogin = (userNick, userPassword, callback) => {\n\n    firebaseConf.auth().signInWithEmailAndPassword(userNick, userPassword).then(function (result) {\n        window.localStorage.setItem('token_inventarioUV', Math.random().toString(36).substr(2) + Math.random().toString(36).substr(2));\n        window.localStorage.setItem('user_inventarioUV', userNick)\n        if (userNick === 'admin@inventariofablab.uv.cl') {\n            window.localStorage.setItem('permisos_inventarioUV', '0')\n        }\n        if (userNick === 'visita@inventariofablab.uv.cl') {\n            window.localStorage.setItem('permisos_inventarioUV', '2')\n        }\n        if (userNick === 'ayudantes@inventariofablab.uv.cl') {\n            window.localStorage.setItem('permisos_inventarioUV', '1')\n        }\n        window.location = '/home';\n    }).catch(() => {\n        callback(false)\n    })\n};\n\n\nexport const getTipoRegistrovsCantidad = (ano, callback, termino) => {\n\n    var query = [];\n    var cont = 0;\n\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano)\n        .where('peticion', \"==\", \"Entrega de producto\").get().then(function (querySnapshot) {\n            query.push({ x: \"Entrega de producto\", y: querySnapshot.size })\n            cont = cont + 1;\n            if (cont === 5) {\n                callback(query)\n                termino(true)\n            }\n        });\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano)\n        .where('peticion', \"==\", \"Devolucion de producto\").get().then(function (querySnapshot) {\n            query.push({ x: \"Devolucion de producto\", y: querySnapshot.size })\n            cont = cont + 1;\n            if (cont === 5) {\n                callback(query)\n                termino(true)\n            }\n        });\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano)\n        .where('peticion', \"==\", \"Actualizar stock\").get().then(function (querySnapshot) {\n            query.push({ x: \"Actualizar stock\", y: querySnapshot.size })\n            cont = cont + 1;\n            if (cont === 5) {\n                callback(query)\n                termino(true)\n            }\n        });\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano)\n        .where('peticion', \"==\", \"Nuevo producto\").get().then(function (querySnapshot) {\n            query.push({ x: \"Nuevo producto\", y: querySnapshot.size })\n            cont = cont + 1;\n            if (cont === 5) {\n                callback(query)\n                termino(true)\n            }\n        });\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", ano)\n        .where('peticion', \"==\", \"Producto removido\").get().then(function (querySnapshot) {\n            query.push({ x: \"Producto removido\", y: querySnapshot.size })\n            cont = cont + 1;\n            if (cont === 5) {\n                callback(query)\n                termino(true)\n            }\n        });\n}\n\nexport const updateHistorica = (ruta, cantidad) => {\n\n    var value;\n    firebaseConf.database().ref().child('productos').child(String(ruta)).once(\"value\", snapshot => {\n        value = snapshot.val().historica_pedidos + cantidad\n        firebaseConf.database().ref().child('productos').child(String(ruta)).update({\n            \"historica_pedidos\": value\n        })\n    })\n}\n\n\nexport const setDatosGrafico = (marca, modelo, cantidad, año, mes) => {\n\n    let temp_subir = { marca: marca, modelo: modelo, cantidad: cantidad, año: año, mes: mes }\n    var bandera = false;\n    firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").orderByChild('modelo')\n        .equalTo(modelo).once('value', function (snapshot) {\n            snapshot.forEach(data => {\n                if (data.val().año === año && data.val().mes === mes && data.val().marca === marca) {\n                    let nueva_cantidad = data.val().cantidad + cantidad\n                    bandera = true;\n                    firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").child(data.key).update({\n                        \"cantidad\": nueva_cantidad\n                    })\n                }\n            })\n        }).finally(() => {\n            if (!bandera) {\n                firebaseConf.database().ref().child('datos-grafico').child('entrega').push(temp_subir)\n            }\n        })\n}\n\nexport const getDatosHistoricosProductos = (callback) => {\n    var return_value = []\n    firebaseConf.database().ref().child('productos').orderByChild('historica_pedidos').\n        limitToLast(5).once('value', snapshot => {\n            snapshot.forEach((data) => {\n                return_value.push({ id: data.val().marca + \" - \" + data.val().modelo, label: data.val().marca + \"  \" + data.val().modelo, value: data.val().historica_pedidos })\n            })\n            callback(return_value)\n        })\n}\n\nexport const getDatosGraficosBarra = (año, mes, callbackdatos) => {\n    var temp_datos = []\n    var datos_enviar = []\n    var key = []\n\n    firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").orderByChild('cantidad').once('value', function (snapshot) {\n        snapshot.forEach((dato) => {\n            if (dato.val().año === año && dato.val().mes === mes) {\n                temp_datos.push(dato.val())\n            }\n        })\n    }).finally(() => {\n        temp_datos.reverse().forEach(datos => {\n            if (datos_enviar.length < 10) {\n                datos_enviar.push({ id: datos.marca + \" - \" + datos.modelo, label: datos.marca + \"  \" + datos.modelo, value: datos.cantidad })\n            }\n        })\n        callbackdatos(datos_enviar)\n    })\n}\n\nexport const getListaRegistroHome = (callback, termino) => {\n    const temp = [];\n    firebaseConf.firestore().collection('registros').orderBy('fecha').limitToLast(3).onSnapshot(querySnapshot => {\n        querySnapshot.forEach(data => {\n            temp.push(data.data())\n        })\n        callback(temp.reverse());\n        termino(true)\n    })\n};\n\n\nexport const getTipoRegistroHome = (callback, termino) => {\n\n    var cont = 0;\n    var date = new Date();\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", date.getFullYear())\n        .get().then(function (snapshot) {\n            cont = snapshot.size;\n        }).finally(() => {\n            callback(cont);\n            termino(true)\n        });\n}\n\nexport const getEntregasMes = (callback, termino) => {\n    var cont = 0\n    var date = new Date();\n    let año = date.getFullYear(); let mes = date.getMonth();\n\n    firebaseConf.database().ref().child(\"datos-grafico\").child(\"entrega\").orderByChild('cantidad').once('value', function (snapshot) {\n        snapshot.forEach((dato) => {\n            if (dato.val().año === año && dato.val().mes === mes) {\n                cont = cont + dato.val().cantidad;\n            }\n        })\n    }).finally(() => {\n        callback(cont);\n        termino(true)\n    })\n}\n\nexport const getDevolucionesHome = (callback, termino) => {\n    var cont = 0\n\n    firebaseConf.database().ref().child(\"productos\").once('value', function (snapshot) {\n        snapshot.forEach((dato) => {\n            if (dato.val().stock !== dato.val().disponible) {\n                cont++;\n            }\n        })\n    }).finally(() => {\n        callback(cont);\n        termino(true)\n    })\n}\n\n\nexport const getRegistrosMensual = (callback, termino) => {\n\n    var cont = 0;\n    var date = new Date();\n    firebaseConf.firestore().collection('registros').where(\"año\", \"==\", date.getFullYear()).where(\"mes\", \"==\", date.getMonth())\n        .get().then(function (snapshot) {\n            cont = snapshot.size;\n        }).finally(() => {\n            callback(cont);\n            termino(true)\n        });\n}\n\nexport const setArchivo = (archivo, nombre, callback, porcentaje, termino) => {\n\n    var ruta_nombre = Date.now() + \"-\" + nombre \n    firebaseConf.storage().ref('registros/resoluciones/' + ruta_nombre).put(archivo).on('state_changed', (snapshot) => {\n        var temp = (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n        porcentaje(temp)\n    }, (error) => {\n        console.log(\"error \" + error)\n        alert(\"Error al subir los datos \" + error)\n        termino(false)\n    }, () => {\n            firebaseConf.storage().ref('registros/resoluciones').child(ruta_nombre).getDownloadURL().then( url => {\n                callback(String(url))\n                termino(true)\n            })\n        \n    })\n\n}"]},"metadata":{},"sourceType":"module"}